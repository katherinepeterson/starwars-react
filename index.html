<html>
    <head>
        <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
        <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
        <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
        <link rel='stylesheet' href='https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css' />
    </head>
    <body>
        <div id='root'></div>
    <script type='text/babel'>
        
        const ListPeople = ({people})=> {
            return (
                <ul>
                    {
                        people.map(person=> {
                        return (
                        <li key={people.indexOf(person)}>
                            <a href={`#${people.indexOf(person)}`}>
                            {person.name}
                            </a>
                        </li>
                        )
                    })
                    }
                </ul>
            )
        }

        const Details = ({person})=> {
        
            return (
                <ul>
                    <li>Name: {person.name}</li>
                    <li>Hair Color: {person.hair_color}</li>
                    <li>Height: {person.height}</li>
                    <li>Eye Color: {person.eye_color}</li>
                    <li>Birth Year: {person.birth_year}</li>
                    <li>Homeworld: {person.homeworld}</li>
                </ul>
            )
        }
        
        class Main extends React.Component{
        constructor(){
            super();
            this.state = {
            people: [],
            id: null
            };
        }
        async componentDidMount(){
            try {
                const result = await fetch('https://swapi.co/api/people/')
                const people = await result.json()
                console.log(people)
                this.setState({people: people.results})
            }
            catch(err){
                console.log('there was an error')
            }
            window.addEventListener('hashchange', ()=>{
            const id = window.location.hash.slice(1)*1;
            this.setState({ id });
            });
            if(window.location.hash.length > 1){
            const id = window.location.hash.slice(1)*1;
            this.setState({ id });
            }
        }
        
        render(){
            
            return (
            <div>
                <div>
                <h1>Star Wars - React Style</h1>
                <ListPeople people = {this.state.people}/>
                </div>
                <div>
                {this.state.id !== null ? (<Details person = {this.state.people[this.state.id]}/>) : (null)}
                </div>
            </div>
            );
        }
        }
        const root = document.querySelector('#root');
        ReactDOM.render(<Main />, root);
    </script>
    </body>
</html>